<INSERT FULL FINAL CODE HERE FROM ABOVE RESPONSE>